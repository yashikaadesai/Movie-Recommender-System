# Movie Recommender System

- **Description**: A small movie recommender prototype using MovieLens-style CSVs, a MongoDB backend, EDA visualizations (Plotly), and a simple Flask web UI with user- and item-based collaborative filtering. Optional Spark helpers are included for large-scale similarity computation.

**Quick Start**
- Clone the repo and open the project root where `requirements.txt` lives.
- Create and activate a virtual environment (macOS example):
```bash
python3 -m venv .venv
source .venv/bin/activate
python -m pip install --upgrade pip
pip install -r requirements.txt
```

**Environment Variables**
- Create a `.env` file in the project root with at least the following values:
```
MONGODB_URL="<your-mongodb-uri>"
FLASK_SECRET_KEY="replace-with-a-secret"
```
- If you use MongoDB Atlas, include the full connection URI. See the Troubleshooting section if you get TLS/SSL errors connecting to Atlas.

**Run the web app (development)**
```bash
# from the project root
source .venv/bin/activate
python codebase/app.py
```
Open http://127.0.0.1:5000 in your browser. Use a numeric `userId` that exists in the `ratings` collection to log in.

**Run ingestion (CSV -> MongoDB)**
- There is an ingestion script to load `dataset/*.csv` into MongoDB collections. Set `MONGODB_URL` and run it from the project root:
```bash
source .venv/bin/activate
python templates/ingestion.py
```

**EDA (visual reports)**
- Visualizations are generated by the EDA script (Plotly). The script writes PNG or HTML fallbacks into `codebase/templates/` when run. If you want static PNG exports, install `kaleido` in the venv.

**Optional: Spark / Hadoop helpers**
- For large datasets, the repo contains Spark-based similarity helpers in `codebase/rec_algos.py`. You can run these locally with `pyspark` (no Hadoop download required for local testing) but production use on a cluster requires proper Spark/cluster setup.

**Troubleshooting**
- TLS/SSL errors when connecting to MongoDB Atlas: if you get an SSL handshake or ServerSelectionTimeout error, try:
  - Upgrading `pymongo`, `dnspython`, and `certifi` in the venv.
  - Passing the CA bundle to `MongoClient` calls: `MongoClient(uri, tlsCAFile=certifi.where())` (requires `import certifi`).
  - Ensuring your Python/OpenSSL build supports modern TLS versions.
- Missing template errors: the app explicitly uses `codebase/templates` as the template folder. Don't move templates out of that folder unless you update `app.py`.

**Repository notes**
- Data lives under `dataset/` (CSV inputs). The app expects MongoDB collections named `movies`, `ratings`, `tags`, and `links`.
- The Flask app entrypoint is `codebase/app.py`.

**Next recommended steps**
- Add `.DS_Store` to `.gitignore` to avoid accidental macOS file commits.
- Create a `.env.example` that documents required env variables (do not commit real secrets).

**License & Contributing**
- This repo does not include a license file. Add a license if you plan to share publicly.

If you want, I can (pick one):
- add `.DS_Store` to `.gitignore` and commit it,
- create a `.env.example`, or
- add `certifi` and `kaleido` to `requirements.txt` and run a quick local smoke test.
